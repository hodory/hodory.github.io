<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>［JS］Knex와 Webpack을 같이 쓰면서 발생한 오류 처리 - Web Developer Hodory</title><meta name=Description content="This is my cool site"><meta property="og:title" content="［JS］Knex와 Webpack을 같이 쓰면서 발생한 오류 처리"><meta property="og:description" content="ERROR in './node_modules/knex/lib/dialects/mssql/index.js' Module not found: Error : Can't resolve 'mssql/lib/base' 프로젝트에 웹팩을 도입하여 사용중, knex 라이브러리를 넣고 나서 웹팩으로 빌드시 해당 에러가 나와서 빌드에 실패 했습니다.
해당 오류를 검색 하였는데, 역시나 깃허브 이슈가 있었고(감사합니다), webpack의 config에 아래의 내용을 추가 하였습니다.
externals: { knex: 'commonjs knex' } 해당 작업 후 빌드는 성공했지만, 노드 서버에서 실행시 knex 모듈을 찾을 수 없다는 오류가 나왔습니다.
{ &#34;errorMessage&#34;: &#34;Cannot find module 'knex'&#34;, &#34;errorType&#34;: &#34;Error&#34;, &#34;stackTrace&#34;: [ &#34;Function."><meta property="og:type" content="article"><meta property="og:url" content="http://blog.hodory.dev/2019/04/jsknex%EC%99%80-webpack%EC%9D%84-%EA%B0%99%EC%9D%B4-%EC%93%B0%EB%A9%B4%EC%84%9C-%EB%B0%9C%EC%83%9D%ED%95%9C-%EC%98%A4%EB%A5%98-%EC%B2%98%EB%A6%AC/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-04-18T19:10:52+00:00"><meta property="article:modified_time" content="2019-04-18T19:10:52+00:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary"><meta name=twitter:title content="［JS］Knex와 Webpack을 같이 쓰면서 발생한 오류 처리"><meta name=twitter:description content="ERROR in './node_modules/knex/lib/dialects/mssql/index.js' Module not found: Error : Can't resolve 'mssql/lib/base' 프로젝트에 웹팩을 도입하여 사용중, knex 라이브러리를 넣고 나서 웹팩으로 빌드시 해당 에러가 나와서 빌드에 실패 했습니다.
해당 오류를 검색 하였는데, 역시나 깃허브 이슈가 있었고(감사합니다), webpack의 config에 아래의 내용을 추가 하였습니다.
externals: { knex: 'commonjs knex' } 해당 작업 후 빌드는 성공했지만, 노드 서버에서 실행시 knex 모듈을 찾을 수 없다는 오류가 나왔습니다.
{ &#34;errorMessage&#34;: &#34;Cannot find module 'knex'&#34;, &#34;errorType&#34;: &#34;Error&#34;, &#34;stackTrace&#34;: [ &#34;Function."><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://blog.hodory.dev/2019/04/jsknex%EC%99%80-webpack%EC%9D%84-%EA%B0%99%EC%9D%B4-%EC%93%B0%EB%A9%B4%EC%84%9C-%EB%B0%9C%EC%83%9D%ED%95%9C-%EC%98%A4%EB%A5%98-%EC%B2%98%EB%A6%AC/><link rel=prev href=http://blog.hodory.dev/2018/10/php%EB%B0%B0%EC%97%B4-key%EC%9D%98-min-%EB%98%90%EB%8A%94-max-%EA%B5%AC%ED%95%98%EA%B8%B0/><link rel=next href=http://blog.hodory.dev/2019/04/laravelwith-has-wherehas-%EB%AD%90%EA%B0%80-%EB%8B%A4%EB%A5%BC%EA%B9%8C/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"［JS］Knex와 Webpack을 같이 쓰면서 발생한 오류 처리","inLanguage":"ko-KR","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/blog.hodory.dev\/2019\/04\/jsknex%EC%99%80-webpack%EC%9D%84-%EA%B0%99%EC%9D%B4-%EC%93%B0%EB%A9%B4%EC%84%9C-%EB%B0%9C%EC%83%9D%ED%95%9C-%EC%98%A4%EB%A5%98-%EC%B2%98%EB%A6%AC\/"},"genre":"posts","keywords":"Javascript, JS, Webpack","wordcount":220,"url":"http:\/\/blog.hodory.dev\/2019\/04\/jsknex%EC%99%80-webpack%EC%9D%84-%EA%B0%99%EC%9D%B4-%EC%93%B0%EB%A9%B4%EC%84%9C-%EB%B0%9C%EC%83%9D%ED%95%9C-%EC%98%A4%EB%A5%98-%EC%B2%98%EB%A6%AC\/","datePublished":"2019-04-18T19:10:52+00:00","dateModified":"2019-04-18T19:10:52+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Author"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Web Developer Hodory"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/logo.png data-srcset="/images/logo.png, /images/logo.png 1.5x, /images/logo.png 2x" data-sizes=auto alt=/images/logo.png title=/images/logo.png><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Web Developer Hodory"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/logo.png data-srcset="/images/logo.png, /images/logo.png 1.5x, /images/logo.png 2x" data-sizes=auto alt=/images/logo.png title=/images/logo.png><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">［JS］Knex와 Webpack을 같이 쓰면서 발생한 오류 처리</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>hodory</a></span>&nbsp;<span class=post-category>included in <a href=/categories/javascript/><i class="far fa-folder fa-fw" aria-hidden=true></i>Javascript</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2019-04-18>2019-04-18</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;220 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;2 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents></nav></div></div><div class=content id=content><pre tabindex=0><code>ERROR in &#39;./node_modules/knex/lib/dialects/mssql/index.js&#39;
Module not found: Error : Can&#39;t resolve &#39;mssql/lib/base&#39;
</code></pre><p>프로젝트에 웹팩을 도입하여 사용중, <code>knex</code> 라이브러리를 넣고 나서
웹팩으로 빌드시 해당 에러가 나와서 빌드에 실패 했습니다.</p><p>해당 오류를 검색 하였는데,
역시나 <a href=https://github.com/tgriesser/knex/issues/1128#issuecomment-312735118 target=_blank rel="noopener noreffer">깃허브 이슈</a>가 있었고(감사합니다),
webpack의 config에 아래의 내용을 추가 하였습니다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>  <span style=color:#a6e22e>externals</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>knex</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;commonjs knex&#39;</span>
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><p>해당 작업 후 빌드는 성공했지만,
노드 서버에서 실행시 knex 모듈을 찾을 수 없다는 오류가 나왔습니다.</p><pre tabindex=0><code>{
  &#34;errorMessage&#34;: &#34;Cannot find module &#39;knex&#39;&#34;,
  &#34;errorType&#34;: &#34;Error&#34;,
  &#34;stackTrace&#34;: [
    &#34;Function.Module._load (module.js:474:25)&#34;,
    &#34;Module.require (module.js:596:17)&#34;,
    &#34;require (internal/module.js:11:18)&#34;,
    &#34;Object.defineProperty.value (/var/task/main.js:1604:18)&#34;,
    &#34;__webpack_require__ (/var/task/main.js:20:30)&#34;,
    &#34;Object.&lt;anonymous&gt; (/var/task/main.js:1564:14)&#34;,
    &#34;__webpack_require__ (/var/task/main.js:20:30)&#34;,
    &#34;Object.defineProperty.value (/var/task/main.js:1442:20)&#34;,
    &#34;__webpack_require__ (/var/task/main.js:20:30)&#34;
  ]
}
</code></pre><p>계속해서 구글링하던중, 다른분의 도움으로 <a href=https://github.com/tgriesser/knex/issues/1446#issuecomment-253245823 target=_blank rel="noopener noreffer">해당 이슈</a> 코멘트를 찾았습니다.
해당 코드를 참고하여 mysql2 라이브러리를 사용했기때문에 아래와 같은 코드를 추가 하였습니다.</p><pre tabindex=0><code>{
  plugins: [
    new webpack.NormalModuleReplacementPlugin(/\.\.migrate/, &#39;../util/noop.js&#39;),
    new webpack.NormalModuleReplacementPlugin(/\.\.seed/, &#39;../util/noop.js&#39;),
    new webpack.IgnorePlugin(/mariasql/, /knex/),
    new webpack.IgnorePlugin(/mysql/, /knex/),
    new webpack.IgnorePlugin(/mssql/, /knex/),
    new webpack.IgnorePlugin(/oracle/, /knex/),
    new webpack.IgnorePlugin(/oracledb/, /knex/),
    new webpack.IgnorePlugin(/postgres/, /knex/),
    new webpack.IgnorePlugin(/redshift/, /knex/),
    new webpack.IgnorePlugin(/pg-query-stream/, /knex/),
    new webpack.IgnorePlugin(/sqlite3/, /knex/),
    new webpack.IgnorePlugin(/strong-oracle/, /knex/),
    new webpack.IgnorePlugin(/pg-native/, /pg/)
  ]
}
</code></pre><p>빌드는 성공 했으나 정상 동작하지 않아 확인 해보니 <code>/node_modules/knex/lib/mysql2/index.js</code> 해당 파일에</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://github.com/hodory/hodory.github.io/blob/master/images/need-mysql.png data-srcset="https://github.com/hodory/hodory.github.io/blob/master/images/need-mysql.png, https://github.com/hodory/hodory.github.io/blob/master/images/need-mysql.png 1.5x, https://github.com/hodory/hodory.github.io/blob/master/images/need-mysql.png 2x" data-sizes=auto alt=https://github.com/hodory/hodory.github.io/blob/master/images/need-mysql.png title=/node_modules/knex/lib/mysql2/index.js></p><p>이러한 코드가 있어서 결국 mysql2를 쓰더라도 mysql 라이브러리가 필요하였습니다.</p><p>굳이 mysql2 모듈을 고집 할 필요가 없을것 같아, mysql 모듈로 변경하고,
<code>new webpack.IgnorePlugin(/mysql/, /knex/)</code> 를 <code>new webpack.IgnorePlugin(/mysql2/, /knex/),</code> 로 변경하니
빌드도 성공하였으며, 정상 동작 하였습니다.</p><p>더 좋은 방법이 있을거 같은데 아쉽게도 제가 찾은 방법은 이것 밖에 없었습니다.
좋은 해결 방안 있으면 댓글로 공유 부탁 드리겠습니다.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2019-04-18</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=http://blog.hodory.dev/2019/04/jsknex%EC%99%80-webpack%EC%9D%84-%EA%B0%99%EC%9D%B4-%EC%93%B0%EB%A9%B4%EC%84%9C-%EB%B0%9C%EC%83%9D%ED%95%9C-%EC%98%A4%EB%A5%98-%EC%B2%98%EB%A6%AC/ data-title="［JS］Knex와 Webpack을 같이 쓰면서 발생한 오류 처리" data-hashtags=Javascript,JS,Webpack><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=http://blog.hodory.dev/2019/04/jsknex%EC%99%80-webpack%EC%9D%84-%EA%B0%99%EC%9D%B4-%EC%93%B0%EB%A9%B4%EC%84%9C-%EB%B0%9C%EC%83%9D%ED%95%9C-%EC%98%A4%EB%A5%98-%EC%B2%98%EB%A6%AC/ data-hashtag=Javascript><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=http://blog.hodory.dev/2019/04/jsknex%EC%99%80-webpack%EC%9D%84-%EA%B0%99%EC%9D%B4-%EC%93%B0%EB%A9%B4%EC%84%9C-%EB%B0%9C%EC%83%9D%ED%95%9C-%EC%98%A4%EB%A5%98-%EC%B2%98%EB%A6%AC/ data-title="［JS］Knex와 Webpack을 같이 쓰면서 발생한 오류 처리"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=http://blog.hodory.dev/2019/04/jsknex%EC%99%80-webpack%EC%9D%84-%EA%B0%99%EC%9D%B4-%EC%93%B0%EB%A9%B4%EC%84%9C-%EB%B0%9C%EC%83%9D%ED%95%9C-%EC%98%A4%EB%A5%98-%EC%B2%98%EB%A6%AC/ data-title="［JS］Knex와 Webpack을 같이 쓰면서 발생한 오류 처리"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=http://blog.hodory.dev/2019/04/jsknex%EC%99%80-webpack%EC%9D%84-%EA%B0%99%EC%9D%B4-%EC%93%B0%EB%A9%B4%EC%84%9C-%EB%B0%9C%EC%83%9D%ED%95%9C-%EC%98%A4%EB%A5%98-%EC%B2%98%EB%A6%AC/ data-title="［JS］Knex와 Webpack을 같이 쓰면서 발생한 오류 처리"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/javascript/>Javascript</a>,&nbsp;<a href=/tags/js/>JS</a>,&nbsp;<a href=/tags/webpack/>Webpack</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2018/10/php%EB%B0%B0%EC%97%B4-key%EC%9D%98-min-%EB%98%90%EB%8A%94-max-%EA%B5%AC%ED%95%98%EA%B8%B0/ class=prev rel=prev title="［PHP］배열 key의 min 또는 max 구하기"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>［PHP］배열 key의 min 또는 max 구하기</a>
<a href=/2019/04/laravelwith-has-wherehas-%EB%AD%90%EA%B0%80-%EB%8B%A4%EB%A5%BC%EA%B9%8C/ class=next rel=next title="［Laravel］with() | has() | whereHas() 뭐가 다를까">［Laravel］with() | has() | whereHas() 뭐가 다를까<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.110.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2023</span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},data:{"id-1":"Web Developer Hodory","id-2":"Web Developer Hodory"},typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","360040228",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=360040228" async></script></body></html>